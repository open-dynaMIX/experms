experms
version 0.1.0 - 2015

Distributed under the GNU GPL
http://www.gnu.org/licenses/gpl-3.0.txt
Or see the file ./COPYING


==========
CONTENT:
==========
 - DESCRIPTION
 - DEPENDENCIES
 - USAGE
 - THE CONFIGURATION FILE
   - EXAMPLE
   - GENERAL SECTION
   - DEFAULT SECTION
   - DIRECTORY SECTION
 - RUNNING EXPERMS AS NON-ROOT USER
 - INOTIFY CONFIGURATION
 - FILES


===============================================================================
 ++ DESCRIPTION ++
===============================================================================
Monitors file-changes happened in the directory set in experms.conf.
If changes happened, it adjusts the file-permissions and ownership/group.
You can either define one directory, or several sub-directories with different
ownerships and permissions.
It also allows exclusions based on directories or patterns (regex).
Further it is able to restore all the ownerships and permissions of all files
based on the config-file.
experms needs to be run with root-permissions.


===============================================================================
 ++ DEPENDENCIES ++
===============================================================================
experms depends on:

 - python2
 - python2-pyinotify (name can vary on different Linux distributions)


===============================================================================
 ++ USAGE ++
===============================================================================
usage: experms [-h] [-d] [-r] [-v] [-c]

experms

optional arguments:
  -h, --help     show this help message and exit
  -d, --debug    Print debug-messages.
  -r, --restore  Just restore all the permissions and exit.
  -v, --version  Print the version and exit.
  -c, --count    Count the directories to watch and exit.


Note: You need to edit the configuration file before running experms the first
      time!


===============================================================================
 ++ THE CONFIGURATION FILE ++
===============================================================================
experms.conf is located under /etc/experms.conf.

If changes happened to experms.conf, it is necessary to restart
experms.

=========
EXAMPLE:
=========
#
# /etc/experms.conf
#

[general]
log_activities = no
restore = no

[DEFAULT]
chmodd = 755

[directory_1]
path = /first/directory
user = first-user
group = first-group
chmodf = 640
chmodd = g+w
excludepath = /first/directory/exclude1,/first/directory/subdir/exclude2

[directory_2]
path = /second/directory
group = second-group
chmodf = 0644
excludepattern = .txt|.TXT|.sh|.SH

=================
GENERAL SECTION:
=================
log_activities = yes | no
   Decide, if experms should write a log-file. If yes, the log will be
   stored in the directory, where experms lies. It also can be
   accessed with 'experms log'.

restore = yes | no
   Decide, if experms should restore all the ownerships and permissions
   of all files based on the config-file. In case there were changes
   while experms was not running.

=================
DEFAULT SECTION:
=================
Rules that should apply to all directory sections. They can be over‚Äê
written inside a directory section.

===================
DIRECTORY SECTION:
===================
path = /path/to/watch/dir
   Set the directory where your rules should apply.

owner = username
   Set the owner of all the files and directories.

group = groupname
   Set the group of all the files and directories.

chmodf = permissions
   Set the permission for all the files.
   Accepted is octal (0777) or symbolic mode (comma separated list).
   Symbolic mode has limited functionality and only supports
   [ugoa][+-=][rwxugo]
   You can use set-UID, set-GID and sticky-bit if you wish to. E.g. 4660.

chmodd = permissions
   Set the permission of all the directories.
   See chmodf above.

excludepath = /path/to/exclude/dir,/path/to/exclude/file...
   Exclude some directories and files from the rules (comma  seperated).

excludepattern = regular expression
   Exclude files (and only files) based on a pattern.


===============================================================================
 ++ INOTIFY CONFIGURATION ++
===============================================================================
experms uses inotify to monitor the directories.
Inotify allows only a limited number of directories to watch per user.
Per default this is set to 8192.
You can increase this number by writing to /proc/sys/fs/inotify/max_user_watches
To make this change permanent, the following line should be added to /etc/sysctl.conf
or /etc/sysctl.d/99-sysctl.conf
fs.inotify.max_user_watches=8192 (your amount of directories)

You can check the amount of directories recursively with:

'experms --count'
